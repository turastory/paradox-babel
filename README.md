# Paradox Babel

<img src="./docs/splash.jpg" height="300">

## The Problem

패러독스의 게임들은 정말 재밌습니다. 하지만 모드는? 영어에 능숙한 사용자가 아니라면 번역이 간절이 필요할 겁니다.

안타깝게도 현재의 모드 시스템에서는 모드 개발자가 각 언어에 해당하는 모드 파일을 제공하지 않으면 인게임에서 해당 모드의 텍스트들이 영어로 fallback 되지 않고 번역 키로 표시되는 문제가 있습니다. (`modular_shipbuilding_desc`, `rule_ztr_historical_content`와 같이 말이죠.)

이는 심각한 문제입니다. 단순히 불편할 뿐 아니라, 번역이 제공되지 않는 모드는 사실상 플레이가 불가능합니다.

유저들은 별도의 번역 모드를 제작하거나, 혹은 모드의 설치 경로를 직접 찾아서 번역 파일을 복제하는 등의 방법으로 어떻게든 대처했지만(`buildings_l_english.yml` -> `buildings_l_korean.yml`), 결국 근본적인 문제를 해결하지는 못했습니다. 게임을 플레이하기 위한 준비 작업에 너무 많은 시간이 필요합니다.

Paradox Babel은 이런 문제를 해결하기 위해 만들어졌습니다. 유저가 번역을 신경 쓰지 않고, 언어에 상관없이 원하는 모드를 바로 사용할 수 있도록 하는 것이죠.

### User Flow

1. 앱을 설치한 후, 스팀 경로와 목표 언어 지정 (Tray 아이콘으로 숨김)
2. 스팀에서 '새 모드' 구독 클릭
3. 앱이 파일 변경을 감지하고 미번역된 키를 추출, 서버로 전송
4. 앱이 번역된 내용을 받아 원하는 언어로 생성
5. 클라이언트를 통해 번역된 정보를 확인하고 게임 실행

### How it works

로컬에서 작동하는 클라이언트와, 번역 정보를 제공하는 서버로 이루어져 있습니다.

1. 클라이언트는 스팀 창작마당 또는 로컬 모드 폴더를 감시합니다.
2. 새로운 모드가 설치되거나 업데이트되면, `localization/english` 폴더와 `localization/${target_lang}` 폴더를 비교합니다.
3. 목표 언어 키가 없거나 비어있는 부분(예: `paranoid_concealers`)만 추출하여 서버로 요청을 보냅니다.
4. 서버에서 받은 번역 데이터를 로컬 파일(`yml`)에 자동으로 덮어씌웁니다.

#### Context-Aware Prompting

게임 용어는 단순 번역하면 어색합니다. (가령 Stellaris의 "Fanatic Purifier"는 "광적인 정화자"로 번역되어야 합니다.)

자연스러운 번역을 위해 패러독스의 각 게임별 공식 번역 파일들과 고유 명사를 가지고 RAG를 만들고, API 호출 시 프롬프트에 사전 정보와 모드에 대한 설명을 주입해서 요청합니다.

<!-- Concrete examples goes here -->


### Technical Details

#### Client

많은 기능이 필요하지 않습니다. 번역 파일 위치를 찾고, 번역 동기화 상태를 스트리밍받는 정도면 충분합니다. 게임에 영향을 주지 않도록 경량화된 클라이언트 구현을 위해 Electron이 아닌 Rust기반의 Tauri를 사용합니다.

#### Server

I/O 처리에 유리한 Node.js 기반의 서버입니다. 클라이언트에서 들어오는 번역 요청을 처리하고, 비용 효율을 위해 한 번 번역했던 데이터는 저장해둔 다음 내려줍니다.

- Deduping: 요청 들어온 텍스트를 해싱해 중복 번역 요청 차단
- Batch Processing: 효율성을 위해 50~100줄씩 묶어서 번역 요청 (Redis Stream 사용)
